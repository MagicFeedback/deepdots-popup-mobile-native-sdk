!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.magicfeedback=t():e.magicfeedback=t()}(self,(()=>{return e={945:function(e,t){var i="undefined"!=typeof self?self:this,n=function(){function e(){this.fetch=!1,this.DOMException=i.DOMException}return e.prototype=i,new e}();!function(e){!function(t){var i="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,a="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),s="FormData"in e,r="ArrayBuffer"in e;if(r)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};function d(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function u(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function p(e){this.map={},e instanceof p?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function h(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function m(e){return new Promise((function(t,i){e.onload=function(){t(e.result)},e.onerror=function(){i(e.error)}}))}function f(e){var t=new FileReader,i=m(t);return t.readAsArrayBuffer(e),i}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:a&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:s&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:i&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():r&&a&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=g(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(f)}),this.text=function(){var e,t,i,n=h(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,i=m(t=new FileReader),t.readAsText(e),i;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),i=new Array(t.length),n=0;n<t.length;n++)i[n]=String.fromCharCode(t[n]);return i.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}p.prototype.append=function(e,t){e=d(e),t=c(t);var i=this.map[e];this.map[e]=i?i+", "+t:t},p.prototype.delete=function(e){delete this.map[d(e)]},p.prototype.get=function(e){return e=d(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(d(e))},p.prototype.set=function(e,t){this.map[d(e)]=c(t)},p.prototype.forEach=function(e,t){for(var i in this.map)this.map.hasOwnProperty(i)&&e.call(t,this.map[i],i,this)},p.prototype.keys=function(){var e=[];return this.forEach((function(t,i){e.push(i)})),u(e)},p.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),u(e)},p.prototype.entries=function(){var e=[];return this.forEach((function(t,i){e.push([i,t])})),u(e)},n&&(p.prototype[Symbol.iterator]=p.prototype.entries);var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function E(e,t){var i,n,a=(t=t||{}).body;if(e instanceof E){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,a||null==e._bodyInit||(a=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(n=(i=t.method||this.method||"GET").toUpperCase(),y.indexOf(n)>-1?n:i),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&a)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(a)}function b(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var i=e.split("="),n=i.shift().replace(/\+/g," "),a=i.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(a))}})),t}function A(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}E.prototype.clone=function(){return new E(this,{body:this._bodyInit})},v.call(E.prototype),v.call(A.prototype),A.prototype.clone=function(){return new A(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},A.error=function(){var e=new A(null,{status:0,statusText:""});return e.type="error",e};var k=[301,302,303,307,308];A.redirect=function(e,t){if(-1===k.indexOf(t))throw new RangeError("Invalid status code");return new A(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var i=Error(e);this.stack=i.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function C(e,i){return new Promise((function(n,s){var r=new E(e,i);if(r.signal&&r.signal.aborted)return s(new t.DOMException("Aborted","AbortError"));var o=new XMLHttpRequest;function l(){o.abort()}o.onload=function(){var e,t,i={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new p,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var i=e.split(":"),n=i.shift().trim();if(n){var a=i.join(":").trim();t.append(n,a)}})),t)};i.url="responseURL"in o?o.responseURL:i.headers.get("X-Request-URL");var a="response"in o?o.response:o.responseText;n(new A(a,i))},o.onerror=function(){s(new TypeError("Network request failed"))},o.ontimeout=function(){s(new TypeError("Network request failed"))},o.onabort=function(){s(new t.DOMException("Aborted","AbortError"))},o.open(r.method,r.url,!0),"include"===r.credentials?o.withCredentials=!0:"omit"===r.credentials&&(o.withCredentials=!1),"responseType"in o&&a&&(o.responseType="blob"),r.headers.forEach((function(e,t){o.setRequestHeader(t,e)})),r.signal&&(r.signal.addEventListener("abort",l),o.onreadystatechange=function(){4===o.readyState&&r.signal.removeEventListener("abort",l)}),o.send(void 0===r._bodyInit?null:r._bodyInit)}))}C.polyfill=!0,e.fetch||(e.fetch=C,e.Headers=p,e.Request=E,e.Response=A),t.Headers=p,t.Request=E,t.Response=A,t.fetch=C,Object.defineProperty(t,"__esModule",{value:!0})}({})}(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var a=n;(t=a.fetch).default=a.fetch,t.fetch=a.fetch,t.Headers=a.Headers,t.Request=a.Request,t.Response=a.Response,e.exports=t},317:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HOST_API_URL_DEV=t.HOST_API_URL=void 0,t.HOST_API_URL="https://api.deepdots.com/",t.HOST_API_URL_DEV="https://api-dev.deepdots.com/"},156:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(i(927));let s=null;s||(s=(0,a.default)()),t.default=s},927:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function o(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=i(57),s=i(665),r=i(256),o=i(313),l=i(317);t.default=function(){const e=new s.Config;let t;return{init:function(i){(null==i?void 0:i.debug)&&e.set("debug",null==i?void 0:i.debug),e.set("url",(null==i?void 0:i.env)&&"dev"===(null==i?void 0:i.env)?l.HOST_API_URL_DEV:l.HOST_API_URL),e.set("env",null==i?void 0:i.env),t=new r.Log(e),t.log("Initialized Magicfeedback",e)},send:function(i,a,s,r=!0,l,d){return n(this,void 0,void 0,(function*(){i||t.err("No appID provided"),a||t.err("No publicKey provided"),s||t.err("No feedback provided"),s.answers||s.profile||s.metrics||s.metadata||t.err("No feedback data provided");const n=e.get("url"),c={integration:i,publicKey:a,privateKey:d,completed:r,id:l,feedback:s};try{const e=yield(0,o.sendFeedback)(n,c,t);return t.log("sent native feedback"),e}catch(e){return t.err("error native feedback",e),!1}}))},form:function(i,n){return i||t.err("No appID provided"),n||t.err("No publicKey provided"),new a.Form(e,i,n)},session:function(i){return i||t.err("No sessionId provided"),new a.Form(e,i)}}}},79:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.History=void 0,t.History=class{constructor(){this.items=[]}enqueue(e){this.items.push(e)}dequeue(){return this.items.shift()}rollback(){return this.items.pop()}front(){return this.items[0]}back(){return this.items[this.items.length-1]}isEmpty(){return 0===this.items.length}size(){return this.items.length}get(e){return this.items[e]}}},665:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Config=void 0,t.Config=class{constructor(){this.variables={},this.variables.env="prod",this.variables.debug=!1}get(e){return this.variables[e]}set(e,t){this.variables[e]=t}}},57:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function o(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Form=void 0;const a=i(558),s=i(256),r=i(313),o=i(213),l=i(217),d=i(700),c=i(591),u=i(79),p=i(636);t.Form=class{constructor(e,t,i){this.config=e,this.log=new s.Log(e),this.formOptionsConfig={addButton:!0,sendButtonText:"Send",backButtonText:"Back",nextButtonText:"Next",addSuccessScreen:!0,getMetaData:!0,questionFormat:"standard"},this.selector="",this.appId=t,this.publicKey=i||"",this.url=e.get("url"),this.id="",this.formData=null,this.feedback={text:"",answers:[],profile:[],metrics:[],metadata:[]},this.history=new u.History,this.graph=new l.PageGraph([]),this.progress=0,this.total=0,this.completed=!1,this.timeToCompleted=0}generate(e,t){var i,a,s,o,l,d,c;return n(this,void 0,void 0,(function*(){try{this.formOptionsConfig=Object.assign(Object.assign({},this.formOptionsConfig),t),this.selector=e;let n=this.formData;if(void 0!==this.formData&&this.formData||(n=""!==this.publicKey?yield(0,r.getForm)(this.url,this.appId,this.publicKey,this.log):yield(0,r.getSessionForm)(this.url,this.appId,this.log)),void 0===n||!n)throw new Error(`No data for app ${this.appId}`);if(null===(i=n.error)||void 0===i?void 0:i.message)throw new Error(n.error.message);if(n.questions=(null===(a=n.questions)||void 0===a?void 0:a.filter((e=>"ACTIVE"===e.status)))||[],n.pages=(null===(s=n.pages)||void 0===s?void 0:s.filter((e=>"ACTIVE"===e.status)))||[],null===(o=n.pages)||void 0===o||o.forEach((e=>{var t;return e.integrationQuestions=null===(t=e.integrationQuestions)||void 0===t?void 0:t.filter((e=>"ACTIVE"===e.status))})),this.formData=n,this.formData.savedAt||(this.formData.savedAt=new Date,localStorage.setItem(`magicfeedback-${this.appId}`,JSON.stringify(this.formData))),void 0===this.formData.questions||!this.formData.questions)throw new Error(`No questions for app ${this.appId}`);this.formData.pages&&0!==(null===(l=this.formData.pages)||void 0===l?void 0:l.length)||this.formatPages(),null===(d=this.formData.questions)||void 0===d||d.sort(((e,t)=>e.position-t.position)),this.formData.pages=this.formData.pages.filter((e=>{var t;return(null===(t=e.integrationQuestions)||void 0===t?void 0:t.length)>0})),this.formOptionsConfig.getMetaData&&this.getMetaData(),(null===(c=this.formData.style)||void 0===c?void 0:c.startMessage)?yield this.generateWelcomeMessage(this.formData.style.startMessage):this.startForm()}catch(e){return this.log.err(e),void(this.formOptionsConfig.onLoadedEvent&&(yield this.formOptionsConfig.onLoadedEvent({loading:!1,error:e})))}}))}formatPages(){var e;if(this.formData)switch(this.formData.identity){case"MAGICSURVEY":this.formData.pages=[],null===(e=this.formData.questions)||void 0===e||e.forEach((e=>{var t,i;const n=new c.PageRoute(e.id,e.ref,c.OperatorType.NOEQUAL,[],c.TransitionType.PAGE,(e.position+1).toString(),e.position.toString()),a=new d.Page(e.position.toString(),e.position,this.appId,[e],[n]);null===(i=null===(t=this.formData)||void 0===t?void 0:t.pages)||void 0===i||i.push(a)}));break;case"MAGICFORM":const t=new d.Page("1",1,this.appId,this.formData.questions,[]);this.formData.pages=[t]}}generateContainer(){let e=document.getElementById(this.selector);if(!e&&(e=document.getElementById("magicfeedback-container-"+this.appId),!e))throw new Error(`Element with ID '${this.selector}' not found.`);return e.classList.add("magicfeedback-container"),e.id="magicfeedback-container-"+this.appId,e.innerHTML="",e}generateForm(){var e,t,i,a;return n(this,void 0,void 0,(function*(){try{if(console.log("Generating form for appId:",this.appId),!this.formData||!this.formData.pages||0===this.formData.pages.length)throw new Error("No form data");this.graph=new l.PageGraph(this.formData.pages.sort(((e,t)=>e.position-t.position)));let n=this.generateContainer();const s=document.createElement("form");s.classList.add("magicfeedback-form"),s.id="magicfeedback-"+this.appId,s.addEventListener("submit",(e=>e.preventDefault()));const r=document.createElement("div");r.classList.add("magicfeedback-questions"),r.id="magicfeedback-questions-"+this.appId;const d=this.graph.getFirstPage();if(!d)throw new Error("No page found");if(this.total=this.graph.findMaxDepth(),d.elements=(0,o.renderQuestions)(d.questions,this.formOptionsConfig.questionFormat,null===(e=this.formData)||void 0===e?void 0:e.lang[0],null===(t=this.formData)||void 0===t?void 0:t.product,(()=>this.send())),null===(i=d.elements)||void 0===i||i.forEach((e=>r.appendChild(e))),s.appendChild(r),this.history.enqueue(d),n.appendChild(s),this.progress=this.total-this.graph.findMaxDepth(d),this.formOptionsConfig.addButton){const e=(0,o.renderActions)(null===(a=this.formData)||void 0===a?void 0:a.identity,(()=>this.back()),this.formOptionsConfig.sendButtonText,this.formOptionsConfig.backButtonText,this.formOptionsConfig.nextButtonText);s.appendChild(e)}this.formOptionsConfig.addButton&&s.addEventListener("submit",(e=>{e.preventDefault(),this.send()})),this.timeToCompleted=(new Date).getTime()/1e3,this.formOptionsConfig.onLoadedEvent&&(yield this.formOptionsConfig.onLoadedEvent({loading:!1,progress:this.progress,total:this.total,formData:this.formData}))}catch(e){return this.log.err(e),void(this.formOptionsConfig.onLoadedEvent&&this.formOptionsConfig.onLoadedEvent({loading:!1,error:e}))}}))}startForm(){this.generateForm()}generateWelcomeMessage(e){return n(this,void 0,void 0,(function*(){try{const t=this.generateContainer(),i=(0,o.renderStartMessage)(e,this.formOptionsConfig.addButton,this.formOptionsConfig.startButtonText,(()=>this.startForm()));t.appendChild(i),this.formOptionsConfig.onLoadedEvent&&(yield this.formOptionsConfig.onLoadedEvent({loading:!1,formData:this.formData}))}catch(e){return this.log.err(e),void(this.formOptionsConfig.onLoadedEvent&&this.formOptionsConfig.onLoadedEvent({loading:!1,error:e}))}}))}getMetaData(){this.feedback.metadata.push({key:"navigator-url",value:[window.location.href]}),this.feedback.metadata.push({key:"navigator-origin",value:[window.location.origin]}),this.feedback.metadata.push({key:"navigator-pathname",value:[window.location.pathname]}),this.feedback.metadata.push({key:"navigator-search",value:[window.location.search]}),this.feedback.metadata.push({key:"navigator-user",value:[navigator.userAgent]}),this.feedback.metadata.push({key:"navigator-language",value:[navigator.language]}),this.feedback.metadata.push({key:"navigator-platform",value:[navigator.platform]}),this.feedback.metadata.push({key:"navigator-appVersion",value:[navigator.appVersion]}),this.feedback.metadata.push({key:"navigator-appName",value:[navigator.appName]}),this.feedback.metadata.push({key:"navigator-product",value:[navigator.product]}),this.feedback.metadata.push({key:"screen-width",value:[window.screen.width.toString()]}),this.feedback.metadata.push({key:"screen-height",value:[window.screen.height.toString()]}),this.appId&&""===this.publicKey&&this.feedback.metadata.push({key:"MAGICFEEDBACK_SESSION",value:[this.appId]})}send(e,t,i){return n(this,void 0,void 0,(function*(){const n=document.getElementById("magicfeedback-questions-"+this.appId);try{i&&(this.feedback.profile=[...this.feedback.profile,...i]),t&&(this.feedback.metrics=[...this.feedback.metrics,...t]),e&&(this.feedback.metadata=[...this.feedback.metadata,...e]),this.answer(),this.formOptionsConfig.beforeSubmitEvent&&(yield this.formOptionsConfig.beforeSubmitEvent({loading:!0,progress:this.progress,total:this.total}));const s=this.history.back();if(!s)throw new Error("No page found");for(const e of s.questions.filter((e=>e.require&&![a.FEEDBACKAPPANSWERTYPE.CONSENT,a.FEEDBACKAPPANSWERTYPE.INFO_PAGE].includes(e.type)))){const t=e.assets,i=this.feedback.answers.filter((t=>t.key.includes(e.ref)&&!t.key.includes("extra-option")));if(0===i.length||i.find((e=>0===e.value.length)))throw this.log.err(`The question ${e.ref} is required`),new Error("No response");if(null==t?void 0:t.minOptions){let n=[];if((null==t?void 0:t.exclusiveAnswers)&&(n=null==t?void 0:t.exclusiveAnswers),!i[0].value.find((e=>n.includes(e)))&&i[0].value.length<(null==t?void 0:t.minOptions))throw this.log.err(`The question ${e.ref} requires at least ${null==t?void 0:t.minOptions} options`),new Error("No response")}}const r=yield this.pushAnswers(!1);if(!r)throw new Error("No response");this.id=r,yield this.processNextQuestion(n)}catch(e){this.log.err(`An error occurred while submitting the form ${this.appId}:`,e),this.formOptionsConfig.afterSubmitEvent&&(yield this.formOptionsConfig.afterSubmitEvent({loading:!1,progress:this.progress,total:this.total,error:e}))}}))}answer(){const e=document.getElementById("magicfeedback-"+this.appId);if(!e)return this.log.err(`Form "${e}" not found.`),void(this.feedback.answers=[]);const t=this.history.back();if(!t)throw new Error("No page found");const i=[];let n=!1;if(e.querySelectorAll(".magicfeedback-input").forEach((e=>{const s=t.questions.find((t=>{var i;return null===(i=e.name)||void 0===i?void 0:i.includes(t.ref)})),o=e.type,l=e.classList[0],d={key:e.name,value:[]},c="magicfeedback-consent"===l?e.checked.toString():e.value;if(d.key&&""!==d.key){switch(null==s?void 0:s.type){case a.FEEDBACKAPPANSWERTYPE.EMAIL:case a.FEEDBACKAPPANSWERTYPE.TEXT:case a.FEEDBACKAPPANSWERTYPE.LONGTEXT:case a.FEEDBACKAPPANSWERTYPE.NUMBER:case a.FEEDBACKAPPANSWERTYPE.DATE:case a.FEEDBACKAPPANSWERTYPE.CONTACT:if(""!==c){if("email"===o){if(!(0,r.validateEmail)(c)){this.log.err("Invalid email"),n=!0;break}this.feedback.profile.push({key:"email",value:[c]})}d.value.push(c)}break;case a.FEEDBACKAPPANSWERTYPE.CONSENT:d.value.push(String(e.checked));break;case a.FEEDBACKAPPANSWERTYPE.POINT_SYSTEM:const t=e.id;d.value.push(`${t}:${c}%`);break;case a.FEEDBACKAPPANSWERTYPE.MULTIPLECHOICE:case a.FEEDBACKAPPANSWERTYPE.MULTIPLECHOISE_IMAGE:case a.FEEDBACKAPPANSWERTYPE.RATING_STAR:case a.FEEDBACKAPPANSWERTYPE.RADIO:case a.FEEDBACKAPPANSWERTYPE.RATING_EMOJI:case a.FEEDBACKAPPANSWERTYPE.RATING_NUMBER:(e.checked||e.id.includes("extra-option-"))&&d.value.push(c);break;case a.FEEDBACKAPPANSWERTYPE.SELECT:d.value.push(c);break;case a.FEEDBACKAPPANSWERTYPE.BOOLEAN:case a.FEEDBACKAPPANSWERTYPE.MULTI_QUESTION_MATRIX:e.checked&&d.value.push(c);break;case a.FEEDBACKAPPANSWERTYPE.PRIORITY_LIST:d.value.push(c)}if((null==i?void 0:i.length)>0&&(null==i?void 0:i.find((e=>e.key===d.key)))){const e=i.findIndex((e=>e.key===d.key));i[e].value=[...i[e].value,...d.value]}else i.push(d)}})),n)return this.feedback.answers=[],void t.setAnswer([]);try{t.questions.filter((e=>e.type===a.FEEDBACKAPPANSWERTYPE.MULTI_QUESTION_MATRIX)).forEach((e=>{const t=e.ref+"-",n=i.filter((e=>e.key.startsWith(t)));if(0===n.length)return;const a=n.map((e=>({key:e.key.substring(t.length),value:e.value}))),s={key:e.ref,value:[JSON.stringify(a)]};for(const e of n){const t=i.findIndex((t=>t.key===e.key));-1!==t&&i.splice(t,1)}const r=i.findIndex((t=>t.key===e.ref));-1!==r?i[r]=s:i.push(s)}))}catch(e){this.log.err("Error agrupando MULTI_QUESTION_MATRIX",e)}this.feedback.answers=i,t.setAnswer(i)}finish(){return n(this,void 0,void 0,(function*(){if(this.completed=!0,this.timeToCompleted=(new Date).getTime()-this.timeToCompleted,this.feedback.metadata.push({key:"time-to-complete",value:[this.timeToCompleted.toString()]}),this.formOptionsConfig.addSuccessScreen){const e=document.getElementById("magicfeedback-container-"+this.appId);e.childNodes.length>0&&e.removeChild(e.childNodes[0]);const t=(0,o.renderSuccess)(this.formOptionsConfig.successMessage||"Thank you for your feedback!");e.appendChild(t)}this.answer();try{const e=yield this.pushAnswers(!0);if(!e)throw this.formOptionsConfig.afterSubmitEvent&&(yield this.formOptionsConfig.afterSubmitEvent({loading:!1,progress:this.progress,total:this.total,completed:this.completed,error:`An error occurred while submitting the form ${this.appId}:`})),new Error("An error occurred while submitting the form ${this.appId}:");this.id=e,this.formOptionsConfig.afterSubmitEvent&&(yield this.formOptionsConfig.afterSubmitEvent({response:this.id,loading:!1,progress:this.progress,total:this.total,completed:this.completed,error:null}))}catch(e){this.log.err(`An error occurred while submitting the form ${this.appId}:`,e),this.formOptionsConfig.afterSubmitEvent&&(yield this.formOptionsConfig.afterSubmitEvent({loading:!1,progress:this.progress,total:this.total,completed:this.completed,error:e}))}}))}pushAnswers(e=!1){return n(this,void 0,void 0,(function*(){try{const t=this.config.get("url"),i={integration:this.appId,publicKey:this.publicKey,feedback:this.feedback,completed:e};return yield(0,r.sendFeedback)(t,this.id?Object.assign(Object.assign({},i),{sessionId:this.id}):i,this.log)}catch(e){return this.log.err(`An error occurred while submitting the form ${this.appId}:`,e),""}}))}callFollowUpQuestion(e){var t;return n(this,void 0,void 0,(function*(){if(!(null==e?void 0:e.followup))return null;try{if(0===this.feedback.answers.length)throw new Error("No answers provided");const i=this.config.get("url"),n=Object.assign(Object.assign(Object.assign({answer:null===(t=this.feedback.answers.find((t=>t.key===e.ref)))||void 0===t?void 0:t.value[0]},""!==this.publicKey&&{publicKey:this.publicKey}),""===this.publicKey&&{campaignSessionId:this.appId}),{sessionId:this.id,question:e});return yield(0,r.getFollowUpQuestion)(i,n,this.log)}catch(e){throw this.log.err(`An error occurred while submitting the form ${this.appId}:`,e),e}}))}processNextQuestion(e){var t,i,a;return n(this,void 0,void 0,(function*(){const n=this.history.back();if(!n)throw new Error("No page found");const s=n.getFollowupQuestions();if(0===(null==s?void 0:s.length))return void(yield this.renderNextQuestion(e,n));const r=[];for(const e of s){const t=n.questions.find((t=>t.ref===e));if(t){const e=yield this.callFollowUpQuestion(t);e&&r.push(e)}}if(0===r.length)return void(yield this.renderNextQuestion(e,n));const l=new d.Page(n.id,n.position,this.appId,r,n.edges),c=new p.PageNode(n.id,n.position,n.edges,l,r,!0);c.elements=(0,o.renderQuestions)(r,this.formOptionsConfig.questionFormat,null===(t=this.formData)||void 0===t?void 0:t.lang[0],null===(i=this.formData)||void 0===i?void 0:i.product,(()=>this.send())),this.history.enqueue(c),this.progress+=.5,e.innerHTML="",null===(a=c.elements)||void 0===a||a.forEach((t=>e.appendChild(t))),this.formOptionsConfig.afterSubmitEvent&&(yield this.formOptionsConfig.afterSubmitEvent({response:this.id,loading:!1,progress:this.progress,total:this.total,followup:c.isFollowup,completed:this.completed,error:null}))}))}renderNextQuestion(e,t){var i,s,r,l,d;return n(this,void 0,void 0,(function*(){let n=this.graph.getNextPage(t,this.feedback.answers);if(!n)return void this.finish();const u=n.edges.filter((e=>"PRECONDITIONAL"===e.typeCondition)).sort(((e,t)=>e.position<t.position?-1:e.position>t.position?1:0));if((null==u?void 0:u.length)>0){let t=null;const r=u.map((e=>e.questionRef));for(let e=this.history.size()-1;e>=0;e--){const n=this.history.get(e);if(n&&(t=null===(i=n.answers)||void 0===i?void 0:i.find((e=>r.includes(e.key))),t))break}let o=!u.some((e=>e.transition===c.TransitionType.ALLOW));if(t)for(const i of u){let r=!1;const l=null===(s=this.formData)||void 0===s?void 0:s.questions.find((e=>e.ref===i.questionRef)),d=Array.isArray(t.value)?t.value:[t.value],u=Array.isArray(i.value)?i.value:[i.value];if((null==l?void 0:l.type)===a.FEEDBACKAPPANSWERTYPE.MULTI_QUESTION_MATRIX)r=this.evaluateMatrixPreconditional(i,t);else switch(i.typeOperator){case"EQUAL":case"INQ":r=d.some((e=>u.includes(e)));break;case"NOEQUAL":case"NINQ":r=d.every((e=>!u.includes(e)));break;case"GREATER":r=d.some((e=>Number(e)>Number(u[0])));break;case"LESS":r=d.some((e=>Number(e)<Number(u[0])));break;case"GREATEREQUAL":r=d.some((e=>Number(e)>=Number(u[0])));break;case"LESSEQUAL":r=d.some((e=>Number(e)<=Number(u[0])))}if(r)switch(this.feedback.answers=[],i.transition){case c.TransitionType.NEXT:return void(n&&(yield this.renderNextQuestion(e,n)));case c.TransitionType.ALLOW:o=!0}}if(!o)return this.feedback.answers=[],void(n&&(yield this.renderNextQuestion(e,n)))}n.elements=(0,o.renderQuestions)(n.questions,this.formOptionsConfig.questionFormat,null===(r=this.formData)||void 0===r?void 0:r.lang[0],null===(l=this.formData)||void 0===l?void 0:l.product,(()=>this.send())),e.innerHTML="",null===(d=n.elements)||void 0===d||d.forEach((t=>e.appendChild(t))),this.history.enqueue(n),this.progress=this.total-this.graph.findMaxDepth(n),this.formOptionsConfig.afterSubmitEvent&&(yield this.formOptionsConfig.afterSubmitEvent({response:this.id,loading:!1,progress:this.progress,total:this.total,followup:n.isFollowup,completed:this.completed,error:null}))}))}back(){var e;return n(this,void 0,void 0,(function*(){if(0===this.history.size())return;const t=document.getElementById("magicfeedback-questions-"+this.appId);t&&t.childNodes.length>0&&(t.innerHTML=""),this.history.rollback();const i=this.history.back();i?(null===(e=i.elements)||void 0===e||e.forEach((e=>t.appendChild(e))),this.progress=this.total-this.graph.findMaxDepth(i)):this.progress=this.history.size(),this.formOptionsConfig.onBackEvent&&(yield this.formOptionsConfig.onBackEvent({loading:!1,progress:this.progress,followup:(null==i?void 0:i.isFollowup)||!1,error:i?null:"No page found"}))}))}previewQuestion(e,t,i){var n,a;const s=Array.isArray(t)?t:[t];if(!s||0===s.length)throw new Error("[MagicFeedback] No question provided for preview");const r=document.getElementById(e);if(!r)throw new Error(`[MagicFeedback] Element with ID '${e}' not found.`);const{format:l=this.formOptionsConfig.questionFormat||"standard",language:d=(null===(n=this.formData)||void 0===n?void 0:n.lang)&&this.formData.lang[0]||"en",product:c=(null===(a=this.formData)||void 0===a?void 0:a.product)||{customIcons:!1},clearContainer:u=!0,wrap:p=!0}=i||{};u&&(r.innerHTML="");let h=[];try{h=(0,o.renderQuestions)(s,l,d,c)}catch(e){throw this.log.err(e),e}let m=r;if(p){const e=document.createElement("div");e.classList.add("magicfeedback-preview-question"),m.appendChild(e),m=e}return h.forEach((e=>m.appendChild(e))),r}parseMatrixAnswerPre(e){if(!e||!e.value)return[];if(1===e.value.length&&"string"==typeof e.value[0]&&e.value[0].trim().startsWith("["))try{const t=JSON.parse(e.value[0]);if(Array.isArray(t))return t}catch(e){return[]}return Array.isArray(e.value)&&e.value.length>0&&"object"==typeof e.value[0]&&null!==e.value[0]&&"key"in e.value[0]?e.value:[]}evaluateMatrixPreconditional(e,t){const i=Array.isArray(e.value)?e.value:[e.value],n=new Set(e.option||[]),a=this.parseMatrixAnswerPre(t);if(!a.length)return!1;const s=n.size>0?a.filter((e=>n.has(e.key))):a;if(!s.length)return!1;switch(e.typeOperator){case"EQUAL":case"INQ":return s.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>i.includes(e)))));case"NOEQUAL":case"NINQ":return s.every((e=>(Array.isArray(e.value)?e.value:[e.value]).every((e=>!i.includes(e)))));case"GREATER":return s.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>i.some((t=>Number(e)>Number(t)))))));case"LESS":return s.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>i.some((t=>Number(e)<Number(t)))))));case"GREATEREQUAL":return s.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>i.some((t=>Number(e)>=Number(t)))))));case"LESSEQUAL":return s.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>i.some((t=>Number(e)<=Number(t)))))));default:return!1}}}},700:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Page=void 0,t.Page=class{constructor(e,t,i,n,a){this.id=e,this.position=t,this.generatedAt=(new Date).toISOString(),this.updatedAt=(new Date).toISOString(),this.status="ACTIVE",this.integrationId=i,this.integrationQuestions=n,this.integrationPageRoutes=a}}},217:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageGraph=void 0;const n=i(636),a=i(558),s=i(591);t.PageGraph=class{constructor(e){this.nodes=new Map,this.buildGraph(e)}buildGraph(e){e.forEach((e=>{var t;e.integrationPageRoutes&&(e.integrationPageRoutes=(null===(t=e.integrationPageRoutes)||void 0===t?void 0:t.sort(((e,t)=>new Date((null==e?void 0:e.generatedAt)||"").getTime()-new Date((null==t?void 0:t.generatedAt)||"").getTime()?"DIRECT"===e.typeCondition?1:-1:0)))||[]);const i=new n.PageNode(e.id,e.position,e.integrationPageRoutes||[],e,e.integrationQuestions);this.nodes.set(i.id,i)}))}getNodeById(e){return this.nodes.get(e)}getNextEdgeByDefault(e){if(!e)return;const t=e.edges.find((e=>e.typeCondition===s.ConditionType.DIRECT));if(!t||![s.TransitionType.FINISH,s.TransitionType.REDIRECT].includes(t.transition)){if(t&&t.transitionDestiny)return t.transitionDestiny;for(const t of this.nodes.values())if(t.position===e.position+1)return t.id}}getFirstPage(){let e,t=Number.MAX_VALUE;for(const i of this.nodes.values())i.position<t&&(t=i.position,e=i);return e}getNextPage(e,t){var i;if(!e)return;e.edges.sort(((e,t)=>"DIRECT"===e.typeCondition?1:"DIRECT"===t.typeCondition?-1:0));const n=e.edges.find((i=>{const n=e.questions.find((e=>e.ref===i.questionRef)),r=null==t?void 0:t.filter((e=>e.key===i.questionRef));if("DIRECT"===i.typeCondition)return!0;if(!r||0===r.length)return!1;if((null==n?void 0:n.type)===a.FEEDBACKAPPANSWERTYPE.MULTI_QUESTION_MATRIX)return this.evaluateMatrixCondition(i,r);const o=Array.isArray(i.value)?i.value:[i.value];switch(i.typeOperator){case s.OperatorType.EQUAL:return r.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>o.includes(e)))));case s.OperatorType.NOEQUAL:return r.every((e=>(Array.isArray(e.value)?e.value:[e.value]).every((e=>!o.includes(e)))));case s.OperatorType.GREATER:return r.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>o.some((t=>Number(e)>Number(t)))))));case s.OperatorType.LESS:return r.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>o.some((t=>Number(e)<Number(t)))))));case s.OperatorType.GREATEREQUAL:return r.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>o.some((t=>Number(e)>=Number(t)))))));case s.OperatorType.LESSEQUAL:return r.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>o.some((t=>Number(e)<=Number(t)))))));case s.OperatorType.INQ:return r.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>o.includes(e)))));case s.OperatorType.NINQ:return r.every((e=>(Array.isArray(e.value)?e.value:[e.value]).every((e=>!o.includes(e)))));default:return!1}}));if(!n){const t=this.getNextEdgeByDefault(e);if(!t)return;return this.getNodeById(t)}switch(n.transition){case s.TransitionType.PAGE:if(!n.transitionDestiny)return;return this.getNodeById(n.transitionDestiny);case s.TransitionType.FINISH:return;case s.TransitionType.REDIRECT:return void(window.location.href=(null===(i=n.transitionDestiny)||void 0===i?void 0:i.includes("?"))?`${n.transitionDestiny}&${window.location.search.slice(1)}`:`${n.transitionDestiny}${window.location.search}`);default:return}}findDepth(e){const t=this.getNodeById(e);if(!t)return 0;const i=new Set;return this.DFSUtil(t,i,0)}findMaxDepth(e){if(e||(e=this.getFirstPage()),!e)return 0;const t=new Set;let i=1;return i=Math.max(i,this.DFSUtil(e,t,i)),i}DFSUtil(e,t,i){t.add(e);let n=i;const a=[...e.edges.filter((e=>e.typeCondition!==s.ConditionType.PRECONDITIONAL))||[]],r=this.getNextEdgeByDefault(e);if(r){const i=this.getNodeById(r);i&&!t.has(i)&&a.push(new s.PageRoute(i.id,"",s.OperatorType.DEFAULT,[""],s.TransitionType.PAGE,i.id,e.id))}for(const e of a){if(!e.transitionDestiny)continue;const a=this.getNodeById(e.transitionDestiny);if(a&&!t.has(a)){const e=a.questions.find((e=>e.followup))?i+2:i+1,s=new Set(t),r=this.DFSUtil(a,s,e);n=Math.max(n,r)}}return n}parseMatrixAnswer(e){if(!e||!e.value)return[];if(1===e.value.length&&"string"==typeof e.value[0]&&e.value[0].trim().startsWith("["))try{const t=JSON.parse(e.value[0]);if(Array.isArray(t))return t}catch(e){return[]}return Array.isArray(e.value)&&e.value.length>0&&"object"==typeof e.value[0]&&null!==e.value[0]&&"key"in e.value[0]?e.value:[]}evaluateMatrixCondition(e,t){const i=Array.isArray(e.value)?e.value:[e.value],n=new Set(e.option||[]),a=t[0],r=this.parseMatrixAnswer(a);if(!r.length)return!1;const o=n.size>0?r.filter((e=>n.has(e.key))):r;if(!o.length)return!1;switch(e.typeOperator){case s.OperatorType.EQUAL:case s.OperatorType.INQ:return o.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>i.includes(e)))));case s.OperatorType.NOEQUAL:case s.OperatorType.NINQ:return o.every((e=>(Array.isArray(e.value)?e.value:[e.value]).every((e=>!i.includes(e)))));case s.OperatorType.GREATER:return o.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>i.some((t=>Number(e)>Number(t)))))));case s.OperatorType.LESS:return o.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>i.some((t=>Number(e)<Number(t)))))));case s.OperatorType.GREATEREQUAL:return o.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>i.some((t=>Number(e)>=Number(t)))))));case s.OperatorType.LESSEQUAL:return o.some((e=>(Array.isArray(e.value)?e.value:[e.value]).some((e=>i.some((t=>Number(e)<=Number(t)))))));default:return!1}}}},636:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageNode=void 0,t.PageNode=class{constructor(e,t,i,n,a,s=!1){this.answers=[],this.id=e,this.position=t,this.edges=i,this.data=n,this.questions=a.sort(((e,t)=>e.position-t.position)),this.elements=[],this.isFollowup=s}getFollowupQuestions(){return this.questions.filter((e=>e.followup)).map((e=>e.ref))}getRequiredQuestions(){return this.questions.filter((e=>e.require)).map((e=>e.ref))}setAnswer(e){this.answers=e}}},591:(e,t)=>{"use strict";var i,n,a,s;Object.defineProperty(t,"__esModule",{value:!0}),t.PageRoute=t.StatusType=t.OperatorType=t.ConditionType=t.TransitionType=void 0,(s=t.TransitionType||(t.TransitionType={})).PAGE="PAGE",s.FINISH="FINISH",s.REDIRECT="REDIRECT",s.NEXT="NEXT",s.ALLOW="ALLOW",function(e){e.LOGICAL="LOGICAL",e.DIRECT="DIRECT",e.PRECONDITIONAL="PRECONDITIONAL"}(i=t.ConditionType||(t.ConditionType={})),(a=t.OperatorType||(t.OperatorType={})).EQUAL="EQUAL",a.NOEQUAL="NOEQUAL",a.GREATER="GREATER",a.LESS="LESS",a.GREATEREQUAL="GREATEREQUAL",a.LESSEQUAL="LESSEQUAL",a.INQ="INQ",a.NINQ="NINQ",a.DEFAULT="DEFAULT",function(e){e.ACTIVE="ACTIVE",e.DEPRECATED="DEPRECATED",e.DELETE="DELETE"}(n=t.StatusType||(t.StatusType={})),t.PageRoute=class{constructor(e,t,a,s,r,o,l,d,c,u){this.id=e,this.questionRef=t,this.typeCondition=d||i.LOGICAL,this.typeOperator=a,this.value=s||[],this.transition=r,this.transitionDestiny=o,this.status=n.ACTIVE,this.generatedAt=new Date,this.updatedAt=new Date,this.integrationPageId=l,this.position=c||0,this.option=u||[]}}},558:(e,t)=>{"use strict";var i,n;Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionType=t.FEEDBACKAPPANSWERTYPE=void 0,(n=t.FEEDBACKAPPANSWERTYPE||(t.FEEDBACKAPPANSWERTYPE={})).CONTACT="CONTACT",n.MULTIPLECHOISE_IMAGE="MULTIPLECHOISE_IMAGE",n.EMAIL="EMAIL",n.RATING_STAR="RATING_STAR",n.RADIO="RADIO",n.MULTIPLECHOICE="MULTIPLECHOICE",n.SELECT="SELECT",n.TEXT="TEXT",n.LONGTEXT="LONGTEXT",n.NUMBER="NUMBER",n.RATING_EMOJI="RATING_EMOJI",n.RATING_NUMBER="RATING_NUMBER",n.DATE="DATE",n.BOOLEAN="BOOLEAN",n.PASSWORD="PASSWORD",n.CONSENT="CONSENT",n.MULTI_QUESTION_MATRIX="MULTI_QUESTION_MATRIX",n.POINT_SYSTEM="POINT_SYSTEM",n.PRIORITY_LIST="PRIORITY_LIST",n.INFO_PAGE="INFO_PAGE",n.UPLOAD_FILE="UPLOAD_FILE",n.UPLOAD_IMAGE="UPLOAD_IMAGE",t.QuestionType=class{},function(e){e.FORM="form",e.DIV="div"}(i||(i={}))},857:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.endpoints=void 0,t.endpoints={sdk:{app:(e,t)=>`sdk/app/${e}/${t}`,app_info:(e,t)=>`sdk/app/${e}/${t}/info`,session:e=>`sdk/app/session/${e}/info`,feedback:"sdk/feedback",followUpQuestion:"sdk/followUpQuestion"}}},784:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.placeholder=void 0,t.placeholder={answer:e=>{switch(e){case"en":default:return"Write your answer here...";case"es":return"Escribe tu respuesta aquÃ­...";case"da":return"Skriv dit svar her...";case"fi":return"Kirjoita vastauksesi tÃ¤hÃ¤n...";case"sv":return"Skriv ditt svar hÃ¤r...";case"no":return"Skriv svaret ditt her...";case"ar":return"Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ù‡Ù†Ø§...";case"bn":return"à¦à¦–à¦¾à¦¨à§‡ à¦†à¦ªà¦¨à¦¾à¦°"}},number:e=>{switch(e){case"en":default:return"Write your number here...";case"es":return"Escribe tu nÃºmero aquÃ­...";case"da":return"Skriv dit nummer her...";case"fi":return"Kirjoita numerosi tÃ¤hÃ¤n...";case"sv":return"Skriv ditt nummer hÃ¤r...";case"no":return"Skriv nummeret ditt her...";case"ar":return"Ø§ÙƒØªØ¨ Ø±Ù‚Ù…Ùƒ Ù‡Ù†Ø§...";case"bn":return"à¦à¦–à¦¾à¦¨à§‡ à¦†à¦ªà¦¨à¦¾à¦°"}},email:e=>{switch(e){case"en":default:return"Write your email here...";case"es":return"Escribe tu correo electrÃ³nico aquÃ­...";case"da":return"Skriv din e-mail her...";case"fi":return"Kirjoita sÃ¤hkÃ¶postiosoitteesi tÃ¤hÃ¤n...";case"sv":return"Skriv din e-post hÃ¤r...";case"no":return"Skriv e-posten din her...";case"ar":return"Ø§ÙƒØªØ¨ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù‡Ù†Ø§...";case"bn":return"à¦à¦–à¦¾à¦¨à§‡ à¦†à¦ªà¦¨à¦¾à¦°"}},date:e=>{switch(e){case"en":default:return"Write your date here...";case"es":return"Escribe tu fecha aquÃ­...";case"da":return"Skriv din dato her...";case"fi":return"Kirjoita pÃ¤ivÃ¤mÃ¤Ã¤rÃ¤si tÃ¤hÃ¤n...";case"sv":return"Skriv ditt datum hÃ¤r...";case"no":return"Skriv datoen din her...";case"ar":return"Ø§ÙƒØªØ¨ ØªØ§Ø±ÙŠØ®Ùƒ Ù‡Ù†Ø§...";case"bn":return"à¦à¦–à¦¾à¦¨à§‡ à¦†à¦ªà¦¨à¦¾à¦°"}},password:e=>{switch(e){case"en":default:return"Write your password here...";case"es":return"Escribe tu contraseÃ±a aquÃ­...";case"da":return"Skriv dit kodeord her...";case"fi":return"Kirjoita salasanasi tÃ¤hÃ¤n...";case"sv":return"Skriv ditt lÃ¶senord hÃ¤r...";case"no":return"Skriv passordet ditt her...";case"ar":return"Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ Ù‡Ù†Ø§...";case"bn":return"à¦à¦–à¦¾à¦¨à§‡ à¦†à¦ªà¦¨à¦¾à¦°"}},pointsystemerror:e=>{switch(e){case"en":default:return"The total points must be 100 %";case"es":return"El total de puntos debe ser 100 %";case"da":return"Samlet antal point skal vÃ¦re 100 %";case"fi":return"Kokonaispisteiden on oltava 100 %";case"sv":return"Totala poÃ¤ng mÃ¥ste vara 100 %";case"no":return"Totalt antall poeng mÃ¥ vÃ¦re 100 %";case"ar":return"ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© 100 %";case"bn":return"à¦®à§‹à¦Ÿ à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿ 100 % à¦¹à¦¤à§‡ à¦¹à¦¬à§‡"}}}},213:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderStartMessage=t.renderSuccess=t.renderError=t.renderActions=t.renderQuestions=void 0;const n=i(558),a=i(784),s="https://survey-dev.magicfeedback.io/assets/emojis";function r(e,t){return e?"object"==typeof e?e[t]||e.en:e:""}function o(e,t,i,n,a,s=!0,r="ltr",o="row"){const l=document.createElement("div");l.classList.add("magicfeedback-rating-placeholder"),l.style.display="flex",l.style.flexDirection=o,l.style.alignItems="center",l.style.justifyContent="space-between",l.style.width=a?`calc(100% - (100% / ${t+1}))`:"100%",l.style.marginRight="auto",s&&window.innerWidth<600&&(l.style.flexDirection="column");const d=document.createElement("span");d.textContent=i,d.classList.add("magicfeedback-rating-placeholder-value"),d.style.fontSize="15px",d.style.textAlign="ltr"===r?"left":"right",d.style.width="50%",(s&&window.innerWidth<600||"column"===o)&&(d.textContent=`${e} = ${i}`,d.style.width="100%",d.style.textAlign="left",d.style.marginBottom="5px");const c=document.createElement("span");return c.textContent=n,c.classList.add("magicfeedback-rating-placeholder-value"),c.style.fontSize="15px",c.style.textAlign="ltr"===r?"right":"left",c.style.width="50%",(s&&window.innerWidth<600||"column"===o)&&(c.textContent=`${t} = ${n}`,c.style.width="100%",c.style.textAlign="left",c.style.marginBottom="5px"),"ltr"===r?(i&&l.appendChild(d),n&&l.appendChild(c)):(n&&l.appendChild(c),i&&l.appendChild(d)),l}t.renderQuestions=function e(t,i="standard",l="en",d={customIcons:!1},c){if(!t)throw new Error("[MagicFeedback] No questions provided");const u=[],{customIcons:p,id:h}=d;return t.forEach((m=>{var f,g;if((null===(g=null===(f=null==m?void 0:m.questionType)||void 0===f?void 0:f.conf)||void 0===g?void 0:g.length)>0){let t=document.createElement("div");t.classList.add("magicfeedback-div");const n=document.createElement("label");n.setAttribute("for",`magicfeedback-${m.id}`),n.textContent=r(m.title,l),n.classList.add("magicfeedback-label"),t.appendChild(n),m.questionType.conf.forEach((e=>{e.ref=m.ref,m.assets[e.id]&&(e.assets={placeholder:m.assets[e.id]})})),e(m.questionType.conf,i,l,d,c).forEach((e=>{t.appendChild(e)})),u.push(t)}else{const e=function(e,t,i,l,d){var c,u,p;let h,m,{id:f,title:g,type:v,ref:y,require:E,value:b,defaultValue:A,assets:k}=e,C=document.createElement("div");C.classList.add("magicfeedback-div");const T=window.innerWidth<600,x="slim"===t?r(g,i):null==k?void 0:k.placeholder,w=(N=y,new URLSearchParams(window.location.search).get(N)),L=(null==k?void 0:k.maxCharacters)||0,P=void 0!==(null==k?void 0:k.randomPosition)&&(null==k?void 0:k.randomPosition),S=(null==k?void 0:k.direction)||"row",O=(null==k?void 0:k.order)||"ltr";var N;switch(v){case n.FEEDBACKAPPANSWERTYPE.TEXT:h=document.createElement("input"),h.type="text",h.placeholder=x||a.placeholder.answer(i||"en"),w&&(h.value=w),h.addEventListener("keyup",(e=>{e.preventDefault(),console.log(e.key,e),"Enter"===e.key&&d&&d()})),m="magicfeedback-text";break;case n.FEEDBACKAPPANSWERTYPE.LONGTEXT:h=document.createElement("textarea"),h.rows=3,L>0&&(h.maxLength=L),h.placeholder=x||a.placeholder.answer(i||"en"),w&&(h.value=w),m="magicfeedback-longtext";break;case n.FEEDBACKAPPANSWERTYPE.NUMBER:h=document.createElement("input"),h.type="number",h.placeholder="slim"===t?r(g,i):a.placeholder.number(i||"en"),m="magicfeedback-number",b.length&&(b.sort(((e,t)=>Number(e)-Number(t))),h.max=b[b.length-1],h.min=b[0],h.value=b[0]),w&&!isNaN(Number(w))&&(h.value=w);break;case n.FEEDBACKAPPANSWERTYPE.RADIO:case n.FEEDBACKAPPANSWERTYPE.MULTIPLECHOICE:h=document.createElement("div"),m="magicfeedback-"+("MULTIPLECHOICE"===v?"checkbox":"radio");let R=b||[];P&&(R=R.sort((()=>Math.random()-.5)));let $=(null==k?void 0:k.exclusiveAnswers)||[];(null==k?void 0:k.extraOption)&&($=$.filter((e=>e!==k.extraOptionText))),$.length>0&&(null==$||$.forEach((e=>{R.includes(e)||R.push(e)}))),(null==k?void 0:k.extraOption)&&!R.includes(null==k?void 0:k.extraOptionText)&&R.push(null==k?void 0:k.extraOptionText),R.forEach(((e,t)=>{const s=document.createElement("div");s.classList.add(`magicfeedback-${"MULTIPLECHOICE"===v?"checkbox":"radio"}-container`);const r=document.createElement("label"),o=document.createElement("input");if(o.id=`rating-${y}-${t}`,o.type="MULTIPLECHOICE"===v?"checkbox":"radio",o.name=y,o.value=e,o.classList.add(m),o.classList.add("magicfeedback-input"),v===n.FEEDBACKAPPANSWERTYPE.MULTIPLECHOICE&&(null==k?void 0:k.maxOptions)&&(null==k?void 0:k.maxOptions)>0&&o.addEventListener("change",(()=>{document.querySelectorAll(`input[name="${y}"]:checked`).length>(null==k?void 0:k.maxOptions)&&(o.checked=!1)})),v===n.FEEDBACKAPPANSWERTYPE.RADIO&&d&&(!(null==k?void 0:k.extraOptionText)||(null==k?void 0:k.extraOptionText)&&e!==(null==k?void 0:k.extraOptionText))&&o.addEventListener("change",(()=>{d()})),e!==A&&e!==w||(o.checked=!0),r.textContent=e,r.htmlFor=`rating-${y}-${t}`,o.addEventListener("change",(t=>{const i=document.getElementById(`extra-option-${y}`);t.target.checked&&$.includes(e)?(console.log("exclusiveAnswers",$,e),R.forEach((t=>{t!==e&&(document.querySelector(`input[value="${t}"]`).checked=!1)})),i&&(i.style.display="none")):$.forEach((t=>{t!==e&&(document.querySelector(`input[value="${t}"]`).checked=!1)})),(null==k?void 0:k.extraOption)&&e===(null==k?void 0:k.extraOptionText)&&i&&(i.style.display=t.target.checked?"block":"none")})),s.appendChild(o),s.appendChild(r),h.appendChild(s),(null==k?void 0:k.extraOption)&&e===(null==k?void 0:k.extraOptionText)){const e=document.createElement("input");e.type="text",e.placeholder=(null==k?void 0:k.extraOptionPlaceholder)||a.placeholder.answer(i||"en"),e.classList.add("magicfeedback-extra-option"),e.classList.add("magicfeedback-input"),e.id=`extra-option-${y}`,e.name=`extra-option-${y}`,e.style.display="none",h.appendChild(e)}}));break;case n.FEEDBACKAPPANSWERTYPE.BOOLEAN:h=document.createElement("div"),m="magicfeedback-radio";const _=document.createElement("div");_.classList.add("magicfeedback-boolean-container"),_.style.display="flex",_.style.flexDirection="row",_.style.justifyContent="space-between",_.style.width="70%",_.style.margin="auto",((null==k?void 0:k.addIcon)?["ðŸ‘","ðŸ‘Ž"]:function(e){switch(e){case"es":return["SÃ­","No"];case"fr":return["Oui","Non"];case"de":return["Ja","Nein"];case"it":return["SÃ¬","No"];case"pt":return["Sim","NÃ£o"];case"nl":return["Ja","Nee"];case"pl":return["Tak","Nie"];case"ru":return["Ð”Ð°","ÐÐµÑ‚"];case"ja":return["ã¯ã„","ã„ã„ãˆ"];case"zh":return["æ˜¯","ä¸"];case"ko":return["ì˜ˆ","ì•„ë‹ˆ"];case"da":case"sv":return["Ja","Nej"];case"fi":return["KyllÃ¤","Ei"];case"no":return["Ja","Nei"];case"ar":return["Ù†Ø¹Ù…","Ù„Ø§"];case"bn":return["à¦¹à§à¦¯à¦¾à¦","à¦¨à¦¾"];default:return["Yes","No"]}}(i)).forEach(((e,t)=>{const i=document.createElement("label");i.classList.add("magicfeedback-boolean-option"),i.htmlFor=`rating-${y}-${t}`,i.style.cursor="pointer",i.style.border="1px solid #000",i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",i.style.margin="auto",i.style.padding="0",i.style.width="45%",i.style.height="38px";const n=document.createElement("label");n.htmlFor=`rating-${y}-${t}`,n.textContent=e,n.style.margin="0",n.style.padding="0";const a=document.createElement("input");a.id=`rating-${y}-${t}`,a.type="radio",a.name=y,a.value=["Yes","No"][t],a.classList.add(m),a.classList.add("magicfeedback-input"),a.style.position="absolute",a.style.opacity="0",a.style.width="0",a.style.height="0",a.style.margin="0",a.addEventListener("change",(()=>{d&&d()})),w&&w.toLowerCase()===a.value.toLowerCase()&&(a.checked=!0),i.appendChild(a),i.appendChild(n),_.appendChild(i)})),h.appendChild(_);break;case n.FEEDBACKAPPANSWERTYPE.RATING_EMOJI:h=document.createElement("div"),m="magicfeedback-rating";const F=document.createElement("div");F.classList.add("magicfeedback-rating-container");const M=(null==k?void 0:k.max)?Number(null==k?void 0:k.max):5,B=(null==k?void 0:k.min)?Number(null==k?void 0:k.min):1,U=o(B,M,null==k?void 0:k.minPlaceholder,null==k?void 0:k.maxPlaceholder,null==k?void 0:k.extraOption);for(let ce=B;ce<=M;ce++){const ue=document.createElement("div");ue.classList.add("magicfeedback-rating-option");const pe=document.createElement("label");pe.htmlFor=`rating-${y}-${ce}`,pe.classList.add("magicfeedback-rating-option-label-container");const he=document.createElement("label");he.htmlFor=`rating-${y}-${ce}`,he.textContent=ce.toString();const me=document.createElement("img");if(me.alt=`face-${y}-${ce}`,me.className=`rating-image${ce}`,0===B&&10===M)me.src=`${l}/${ce}.svg`,me.onerror=()=>me.src=`${s}/${ce}.svg`;else if(1===B&&5===M)switch(ce){case 1:me.src=`${l}/1.svg`,me.onerror=()=>me.src=`${s}/1.svg`;break;case 2:me.src=`${l}/2.svg`,me.onerror=()=>me.src=`${s}/2.svg`;break;case 3:me.src=`${l}/6.svg`,me.onerror=()=>me.src=`${s}/6.svg`;break;case 4:me.src=`${l}/9.svg`,me.onerror=()=>me.src=`${s}/9.svg`;break;case 5:me.src=`${l}/10.svg`,me.onerror=()=>me.src=`${s}/10.svg`}else{const ge=Math.round(10/(M-B)*(ce-B));me.src=`${l}/${ge}.svg`,me.onerror=()=>me.src=`${s}/${ge}.svg`}const fe=document.createElement("input");fe.id=`rating-${y}-${ce}`,fe.type="radio",fe.name=y,fe.value=ce.toString(),fe.classList.add(m),fe.classList.add("magicfeedback-input"),d&&fe.addEventListener("change",(()=>{d()})),w&&w===fe.value&&(fe.checked=!0),pe.appendChild(fe),pe.appendChild(me),pe.appendChild(he),ue.appendChild(pe),F.appendChild(ue)}if((null==k?void 0:k.extraOption)&&(null==k?void 0:k.extraOptionText)){const ve=document.createElement("div");ve.classList.add("magicfeedback-rating-option");const ye=document.createElement("label");ye.htmlFor=`rating-${y}-extra`,ye.classList.add("magicfeedback-rating-option-label-container");const Ee=document.createElement("label");Ee.htmlFor=`rating-${y}-extra`,Ee.textContent=null==k?void 0:k.extraOptionText;const be=document.createElement("img");be.src="https://magicfeedback-c6458-dev.web.app/assets/question.svg",be.alt=`face-${y}-extra`,be.className="magicfeedback-rating-image-extra";const Ae=document.createElement("input");Ae.id=`rating-${y}-extra`,Ae.type="radio",Ae.name=y,Ae.value="-",Ae.classList.add(m),Ae.classList.add("magicfeedback-input"),d&&Ae.addEventListener("change",(()=>{d()})),ye.appendChild(Ae),ye.appendChild(be),ye.appendChild(Ee),ve.appendChild(ye),F.appendChild(ve)}h.appendChild(U),h.appendChild(F);break;case n.FEEDBACKAPPANSWERTYPE.RATING_NUMBER:m="magicfeedback-rating-number",h=function(e,t,i,n,a,s,r,o){const l=document.createElement("div");l.classList.add("magicfeedback-rating-number");const d="ltr"===i?n:`${n}-reverse`,c=document.createElement("div");c.classList.add("magicfeedback-rating-number-container"),c.classList.add(`magicfeedback-rating-number-container-${i}`),c.classList.add(`magicfeedback-rating-number-container-${n}`),c.style.display="flex",c.style.flexDirection=d,c.setAttribute("role","radiogroup"),c.setAttribute("aria-label",(null==t?void 0:t.ariaLabel)||"Rating");const u=(null==t?void 0:t.max)?Number(null==t?void 0:t.max):10,p=(null==t?void 0:t.min)?Number(null==t?void 0:t.min):0,h=!(a||"column"===n);for(let i=p;i<=u;i++){const a=document.createElement("div");a.classList.add("magicfeedback-rating-number-option"),a.classList.add(`magicfeedback-rating-number-option-${n}`);const l=document.createElement("label");if(l.htmlFor=`rating-${e}-${i}`,l.classList.add("magicfeedback-rating-number-option-label-container"),h&&(l.style.position="relative",l.style.overflow="visible"),h){const e=document.createElement("span");e.classList.add("magicfeedback-rating-number-cap"),e.classList.add("magicfeedback-rating-placeholder-value"),e.style.fontSize="14px",e.style.whiteSpace="nowrap",e.style.wordBreak="normal",i===p&&(null==t?void 0:t.minPlaceholder)?(e.textContent=t.minPlaceholder,e.dataset.capType="min"):i===u&&(null==t?void 0:t.maxPlaceholder)?(e.textContent=t.maxPlaceholder,e.dataset.capType="max"):e.dataset.capType="mid",l.appendChild(e)}let d=i.toString();h||(i===p&&(null==t?void 0:t.minPlaceholder)&&(d+=` = ${null==t?void 0:t.minPlaceholder}`),i===u&&(null==t?void 0:t.maxPlaceholder)&&(d+=` = ${null==t?void 0:t.maxPlaceholder}`));const m=document.createElement("input");m.id=`rating-${e}-${i}`,m.type="radio",m.name=e,m.value=i.toString(),m.classList.add(s),m.classList.add("magicfeedback-input"),m.setAttribute("aria-label",`${i}`),r&&m.addEventListener("change",(()=>r())),o&&o===m.value&&(m.checked=!0);const f=document.createElement("label");f.htmlFor=`rating-${e}-${i}`,f.textContent=d,f.classList.add("magicfeedback-rating-number-value"),l.appendChild(m),l.appendChild(f),a.appendChild(l),c.appendChild(a)}if((null==t?void 0:t.extraOption)&&(null==t?void 0:t.extraOptionText)){const n=document.createElement("div");n.classList.add("magicfeedback-rating-number-option");const a=document.createElement("label");if(a.htmlFor=`rating-${e}-extra`,a.classList.add("magicfeedback-rating-number-option-label-container"),h&&(a.style.position="relative",a.style.overflow="visible"),h){const e=document.createElement("span");e.classList.add("magicfeedback-rating-number-cap"),e.dataset.capType="extra",e.style.fontSize="12px",e.style.whiteSpace="nowrap",e.style.wordBreak="normal",a.appendChild(e)}const o=document.createElement("input");o.id=`rating-${e}-extra`,o.type="radio",o.name=e,o.value="-",o.classList.add(s),o.classList.add("magicfeedback-input"),o.setAttribute("aria-label",null==t?void 0:t.extraOptionText),r&&o.addEventListener("change",(()=>r()));const l=document.createElement("label");l.htmlFor=`rating-${e}-extra`,l.textContent=null==t?void 0:t.extraOptionText,l.classList.add("magicfeedback-rating-number-value"),a.appendChild(o),a.appendChild(l),n.appendChild(a),"ltr"===i?c.appendChild(n):c.insertBefore(n,c.firstChild)}return l.appendChild(c),h&&requestAnimationFrame((()=>{const e=Array.from(c.querySelectorAll(".magicfeedback-rating-number-cap"));if(0===e.length)return;let t=0;e.forEach((e=>{var i;if(null===(i=e.textContent)||void 0===i?void 0:i.trim()){const i=e.getBoundingClientRect().height||0;i>t&&(t=i)}})),c.style.position="relative",c.style.paddingTop=`${0===t?"42":t+6}px`,e.forEach((e=>{const n=e.getBoundingClientRect().height||0;console.log(t,n,6),e.style.position="absolute",e.style.top=`-${0===t?"42":t+n}px`,e.style.zIndex="1",e.style.pointerEvents="none",e.style.padding="0",e.style.boxSizing="border-box",e.style.whiteSpace="nowrap",e.style.wordBreak="normal",e.style.maxWidth="none",e.style.width="max-content";const a=e.dataset.capType;"min"===a?("ltr"===i?(e.style.left="10px",e.style.textAlign="left"):(e.style.right="10px",e.style.textAlign="right"),e.style.transform="none"):"max"===a?("ltr"===i?(e.style.right="10px",e.style.textAlign="right"):(e.style.left="10px",e.style.textAlign="left"),e.style.transform="none"):(e.style.left="50%",e.style.transform="translateX(-50%)",e.style.textAlign="center")})),c.style.overflow="visible"})),l}(y,k,O,S,T,m,d,w);break;case n.FEEDBACKAPPANSWERTYPE.RATING_STAR:h=document.createElement("div"),m="magicfeedback-rating-star";const q=function(e,t,i,n=()=>{},a){const s="magicfeedback-rating-star-selected",r=document.createElement("div");r.classList.add("magicfeedback-rating-star-container"),r.style.maxWidth="300px",r.style.margin="auto",r.dataset.originalSelection="0";for(let t=1;t<=5;t++){const i=document.createElement("label");i.classList.add("magicfeedback-rating-star-option");const o=document.createElement("input");o.id=`rating-${e}-${t}`,o.type="radio",o.name=e,o.value=t.toString(),o.style.position="absolute",o.style.opacity="0",o.style.width="0",o.style.height="0",o.classList.add("magicfeedback-input"),a&&a===o.value&&(o.checked=!0),o.addEventListener("change",(()=>{const e=r.querySelectorAll(".rating__star");for(let t=0;t<e.length;t++)t+1<=Number(o.value)?e[t].classList.contains(s)||e[t].classList.add(s):e[t].classList.contains(s)&&e[t].classList.remove(s);r.dataset.originalSelection=o.value,n&&n()})),i.appendChild(o);const l=document.createElement("label");l.htmlFor=`rating-${e}-${t}`,l.classList.add("rating__star"),l.textContent="â˜…",l.style.fontSize="40px",l.style.color="#CCCCCC",l.style.cursor="pointer",l.addEventListener("mouseenter",(()=>{const e=r.querySelectorAll(".rating__star"),i=t-1;e.forEach(((e,t)=>{t<=i?e.classList.contains(s)||e.classList.add(s):e.classList.contains(s)&&e.classList.remove(s)}))})),l.addEventListener("mouseleave",(()=>{const e=Number(r.dataset.originalSelection||"0");r.querySelectorAll(".rating__star").forEach(((t,i)=>{i<e?t.classList.contains(s)||t.classList.add(s):t.classList.contains(s)&&t.classList.remove(s)}))})),i.appendChild(l),r.appendChild(i)}return r.appendChild(o(1,5,t,i,!1,!1)),r}(y,null==k?void 0:k.minPlaceholder,null==k?void 0:k.maxPlaceholder,d,w);h.appendChild(q);break;case n.FEEDBACKAPPANSWERTYPE.MULTIPLECHOISE_IMAGE:h=document.createElement("div"),m="magicfeedback-multiple-choice-image";const j=document.createElement("div");j.classList.add("magicfeedback-multiple-choice-image-container"),j.style.display="flex",j.style.flexDirection="row",j.style.flexWrap="wrap",j.style.justifyContent="center";const Q=b.length;let W=1,K=1;if(window.innerWidth<600)W=1,K=Q;else switch(Q){case 1:case 2:case 3:W=Q,K=1;break;case 4:case 5:case 6:K=2,W=Math.ceil(Q/K);break;case 7:case 8:case 9:K=3,W=Math.ceil(Q/K);break;default:K=4,W=Math.ceil(Q/K)}const G=void 0!==(null==k?void 0:k.addTitle)&&(null==k?void 0:k.addTitle),Y=void 0!==(null==k?void 0:k.multiOption)&&(null==k?void 0:k.multiOption),H=void 0!==(null==k?void 0:k.extraOption)&&(null==k?void 0:k.extraOption);function V(e){try{const{position:t,url:i,value:n}=e,a=document.createElement("label");a.classList.add("magicfeedback-multiple-choice-image-option"),a.style.width=`calc( ${100/W}% - 10px)`,a.style.height=`calc( ${100/K}% - 10px)`,a.style.margin="5px";const s=document.createElement("label");s.htmlFor=`rating-${y}-${t}`,s.classList.add("magicfeedback-image-option-label-container"),s.style.display="flex",s.style.flexDirection="column",s.addEventListener("mouseover",(()=>{s.style.border="2px solid #000"})),s.addEventListener("mouseout",(()=>{s.style.border="none"})),s.addEventListener("click",(()=>{s.style.border="2px solid #000"}));const r=document.createElement("label");r.textContent=n,r.classList.add("magicfeedback-multiple-choice-image-label");const o=document.createElement("input");o.id=`rating-${y}-${t}`,o.type=Y?"checkbox":"radio",o.name=y,o.value=n,o.style.position="absolute",o.style.opacity="0",o.style.width="0",o.style.height="0",o.classList.add("magicfeedback-input"),w&&w===o.value&&(o.checked=!0),!Y&&d&&o.addEventListener("change",(()=>{console.log("send"),d()}));const l=document.createElement("img");l.classList.add("magicfeedback-multiple-choice-image-image"),l.src=i,l.style.cursor="pointer",l.style.backgroundSize="cover",l.style.backgroundPosition="center",l.style.width="100%",l.style.height="100%",l.style.objectFit="cover",l.style.margin="auto",s.appendChild(o),s.appendChild(l),G&&s.appendChild(r),a.appendChild(s),j.appendChild(a)}catch(e){console.error(e)}}P&&(b=b.sort((()=>Math.random()-.5))),b.forEach((e=>V(JSON.parse(e)))),H&&(null==k?void 0:k.extraOptionValue)&&(null==k?void 0:k.extraOptionValue.length)>0&&V(null==k?void 0:k.extraOptionValue[0]),h.appendChild(j);break;case n.FEEDBACKAPPANSWERTYPE.SELECT:h=document.createElement("select"),m="magicfeedback-select";const X=document.createElement("option");X.value="",X.text="slim"===t?r(g,i):A||"Select an option",X.disabled=!0,X.selected=!0,h.appendChild(X),b.forEach((e=>{const t=document.createElement("option");t.value=e,t.text=e,h.appendChild(t)})),w&&b.includes(w)&&(h.value=w),d&&h.addEventListener("change",(()=>{d()}));break;case n.FEEDBACKAPPANSWERTYPE.DATE:h=document.createElement("input"),h.type="date",h.required=E,h.placeholder=x||a.placeholder.date(i||"en"),m="magicfeedback-date",w&&(h.value=w);break;case n.FEEDBACKAPPANSWERTYPE.CONSENT:h=document.createElement("input"),m="magicfeedback-consent",h.type="checkbox",h.id=`magicfeedback-${f}`,h.name=y,h.value="true",h.required=E,h.classList.add("magicfeedback-consent"),h.classList.add("magicfeedback-input"),w&&b.includes(w)&&(h.checked=!0),d&&h.addEventListener("change",(()=>{d()}));break;case n.FEEDBACKAPPANSWERTYPE.EMAIL:h=document.createElement("input"),h.type="email",h.required=E,h.placeholder=x||"you@example.com",m="magicfeedback-email",w&&(h.value=w);break;case n.FEEDBACKAPPANSWERTYPE.PASSWORD:h=document.createElement("input"),h.type="password",h.required=E,h.placeholder=x||a.placeholder.password(i||"en"),m="magicfeedback-password",w&&(h.value=w);break;case n.FEEDBACKAPPANSWERTYPE.MULTI_QUESTION_MATRIX:h=document.createElement("div"),m="magicfeedback-multi-question-matrix";const z=document.createElement("div");z.classList.add("magicfeedback-multi-question-matrix-container");let J=(null==k?void 0:k.options)||[],Z=[...b],ee=[];if(P&&(J=null==J?void 0:J.sort((()=>Math.random()-.5)),Z=[...Z].sort((()=>Math.random()-.5))),(null==k?void 0:k.exclusiveAnswers)&&(ee=null==k?void 0:k.exclusiveAnswers,null==ee||ee.forEach((e=>{Z.includes(e)||Z.push(e)}))),window.innerWidth<600){const ke=document.createElement("div");ke.classList.add("magicfeedback-multi-question-matrix-list"),null==J||J.forEach((e=>{const t=document.createElement("div");t.classList.add("magicfeedback-multi-question-matrix-list-item"),t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="flex-start",t.style.marginBottom="10px";const i=document.createElement("label");i.classList.add("magicfeedback-multi-question-matrix-label"),i.style.paddingBottom="10px",i.textContent=e,t.appendChild(i),Z.forEach((i=>{const n=document.createElement("div");n.classList.add("magicfeedback-radio-container"),n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="flex-start",n.style.width="99%",n.style.margin="5px auto";const a=document.createElement("label"),s=document.createElement("input");s.id=`${y}-${e}-${i}`,s.type="radio",s.name=`${y}-${e}`,s.value=i,s.classList.add("magicfeedback-input"),a.textContent=i,a.htmlFor=`${y}-${e}-${i}`,n.appendChild(s),n.appendChild(a),t.appendChild(n)})),ke.appendChild(t)})),z.appendChild(ke)}else{const Ce=document.createElement("table");Ce.classList.add("magicfeedback-multi-question-matrix-table");const Te=document.createElement("thead");Te.classList.add("magicfeedback-multi-question-matrix-header"),Te.style.paddingBottom="15px";const xe=document.createElement("tr"),we=document.createElement("th");xe.appendChild(we),Z.forEach((e=>{const t=document.createElement("th");t.textContent=e,xe.appendChild(t)})),Te.appendChild(xe),Ce.appendChild(Te);const Le=document.createElement("tbody");null==J||J.forEach((e=>{const t=document.createElement("tr");t.classList.add("magicfeedback-multi-question-matrix-row-tr");const i=document.createElement("td");i.style.minWidth="200px";const n=document.createElement("label");n.classList.add("magicfeedback-multi-question-matrix-label"),n.style.paddingRight="20px",n.textContent=e,i.appendChild(n),t.appendChild(i),Z.forEach((i=>{const n=document.createElement("td"),a=document.createElement("input");a.type="radio",a.name=`${y}-${e}`,a.value=i,a.id=`${y}-${e}-${i}`,a.classList.add("magicfeedback-input"),n.appendChild(a),t.appendChild(n)})),Le.appendChild(t)})),Ce.appendChild(Le),z.appendChild(Ce)}h.appendChild(z);break;case n.FEEDBACKAPPANSWERTYPE.PRIORITY_LIST:h=document.createElement("div"),m="magicfeedback-priority-list";const te=document.createElement("div");te.classList.add("magicfeedback-priority-list-container");const ie=document.createElement("ul");ie.classList.add("magicfeedback-priority-list-list"),P&&(b=b.sort((()=>Math.random()-.5))),b.forEach(((e,t)=>{const i=document.createElement("li");i.classList.add("magicfeedback-priority-list-item"),i.style.display="flex",i.style.justifyContent="space-between",i.style.alignItems="center",i.style.margin="5px";const n=document.createElement("input");n.classList.add("magicfeedback-input-magicfeedback-priority-list"),n.classList.add("magicfeedback-input"),n.type="hidden",n.id=`priority-list-${y}`,n.name=y,n.value=`${t+1}. ${e}`,i.appendChild(n);const a=document.createElement("label");a.classList.add("magicfeedback-priority-list-item-label"),a.textContent=`${t+1}. ${e}`,i.appendChild(a);const s=document.createElement("div");s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="space-between";const r=document.createElement("img");r.classList.add("magicfeedback-priority-list-arrow-up"),r.src="https://magicfeedback-c6458-dev.web.app/assets/arrow.svg",r.style.width="20px",r.style.height="20px",r.style.cursor="pointer",r.style.margin="0 5px",r.style.color="#000",r.style.visibility=0===t?"hidden":"visible",r.addEventListener("click",(()=>{var t,s,l,d;const c=i.previousElementSibling;if(c){const u=Number(null===(t=n.value)||void 0===t?void 0:t.split(".")[0])-1;n.value=`${u}. ${e}`,a.textContent=`${u}. ${e}`,r.style.visibility=1===u?"hidden":"visible",o.style.visibility=u===b.length?"hidden":"visible";const p=c.querySelector(".magicfeedback-input-magicfeedback-priority-list"),h=c.querySelector(".magicfeedback-priority-list-item-label"),m=c.querySelector(".magicfeedback-priority-list-arrow-up"),f=c.querySelector(".magicfeedback-priority-list-arrow-down");if(p&&h&&m&&f){const e=Number(null===(s=p.value)||void 0===s?void 0:s.split(".")[0])+1;p.value=`${e}.${null===(l=h.textContent)||void 0===l?void 0:l.split(".")[1]}`,h.textContent=`${e}.${null===(d=h.textContent)||void 0===d?void 0:d.split(".")[1]}`,m.style.visibility=1===e?"hidden":"visible",f.style.visibility=e===b.length?"hidden":"visible"}ie.insertBefore(i,c)}})),s.appendChild(r);const o=document.createElement("img");o.classList.add("magicfeedback-priority-list-arrow-down"),o.src="https://magicfeedback-c6458-dev.web.app/assets/arrow.svg",o.style.width="20px",o.style.height="20px",o.style.cursor="pointer",o.style.margin="0 5px",o.style.color="#000",o.style.transform="rotate(180deg)",o.style.visibility=t===b.length-1?"hidden":"visible",o.addEventListener("click",(()=>{var t,s,l;const d=i.nextElementSibling;if(d){const c=Number(null===(t=n.value)||void 0===t?void 0:t.split(".")[0])+1;n.value=c.toString(),a.textContent=`${c.toString()}. ${e}`,r.style.visibility=1===c?"hidden":"visible",o.style.visibility=c===b.length?"hidden":"visible";const u=d.querySelector(".magicfeedback-input-magicfeedback-priority-list"),p=d.querySelector(".magicfeedback-priority-list-item-label"),h=d.querySelector(".magicfeedback-priority-list-arrow-up"),m=d.querySelector(".magicfeedback-priority-list-arrow-down");if(u&&p&&h&&m){const e=Number(u.value.split(".")[0])-1;u.value=`${e}.${null===(s=p.textContent)||void 0===s?void 0:s.split(".")[1]}`,p.textContent=`${e}.${null===(l=p.textContent)||void 0===l?void 0:l.split(".")[1]}`,h.style.visibility=1===e?"hidden":"visible",m.style.visibility=e===b.length?"hidden":"visible"}ie.insertBefore(d,i)}})),s.appendChild(o),i.appendChild(s),ie.appendChild(i)})),te.appendChild(ie),h.appendChild(te);break;case n.FEEDBACKAPPANSWERTYPE.POINT_SYSTEM:h=document.createElement("div"),m="magicfeedback-point-system";const ne=document.createElement("div");ne.classList.add("magicfeedback-point-system-container");const ae=document.createElement("ul");ae.classList.add("magicfeedback-point-system-list"),ae.style.padding="0";const se=100,re=se/b.length,oe=document.createElement("div");oe.classList.add("magicfeedback-error"),oe.textContent=a.placeholder.pointsystemerror(i||"en"),oe.style.color="#C70039",oe.style.fontSize="14px",oe.style.textAlign="right",oe.style.width="100%",oe.style.display="none";const le=document.createElement("div");le.classList.add("magicfeedback-point-system-total"),le.textContent="0 / 100 %",le.style.textAlign="right",le.style.fontSize="15px",le.style.marginTop="5px",b.forEach(((e,t)=>{const i=document.createElement("li");i.classList.add("magicfeedback-point-system-item"),i.style.display="flex",i.style.justifyContent="space-between",i.style.alignItems="center",i.style.margin="5px";const n=document.createElement("label");n.textContent=e,n.style.fontSize="15px",i.appendChild(n);const a=document.createElement("span");a.classList.add("magicfeedback-point-system-input-container");const s=document.createElement("input");s.name=y,s.id=`${e}`,s.type="number",s.min="0",s.max=`${se}`,s.value="0",s.classList.add("magicfeedback-input"),s.style.width="40px",s.style.border="0",s.style.textAlign="center",s.style.margin="0 5px",s.autofocus=0===t;const r=document.createElement("span");r.textContent="%",r.style.color="#000",s.addEventListener("input",(()=>{const e=ae.querySelectorAll("input");let t=0;e.forEach((e=>{t+=Number(e.value)})),t>se&&(s.value=`${re}%`,t-=Number(s.value));const i=document.getElementById("magicfeedback-submit");i&&(t<100?(le.style.color="orange",i.setAttribute("disabled","true")):(oe.style.display="none",le.style.color="green",i.removeAttribute("disabled"))),le.textContent=`${t} / 100 %`})),s.addEventListener("focus",(()=>{const e=document.getElementById("magicfeedback-submit");e&&(e.setAttribute("disabled","true"),e.addEventListener("pointerover",(()=>{const e=ae.querySelectorAll("input");let t=0;e.forEach((e=>{t+=Number(e.value)})),t<100&&(oe.style.display="block")})))})),a.appendChild(s),a.appendChild(r),i.appendChild(a),ae.appendChild(i)})),ne.appendChild(ae),ne.appendChild(le),ne.appendChild(oe),h.appendChild(ne);break;case n.FEEDBACKAPPANSWERTYPE.INFO_PAGE:h=document.createElement("div"),m="magicfeedback-info-page";const de=document.createElement("div");de.classList.add("magicfeedback-info-message"),de.innerHTML=x,h.appendChild(de);break;case n.FEEDBACKAPPANSWERTYPE.UPLOAD_IMAGE:h=document.createElement("input"),h.type="file",h.accept="image/*",h.required=E,h.multiple=(null==k?void 0:k.multiple)||!1,h.maxLength=(null==k?void 0:k.maxFiles)||1,m="magicfeedback-upload-image";break;case n.FEEDBACKAPPANSWERTYPE.UPLOAD_FILE:h=document.createElement("input"),h.type="file",h.required=E,h.multiple=(null==k?void 0:k.multiple)||!1,h.maxLength=(null==k?void 0:k.maxFiles)||1,m="magicfeedback-upload-file";break;default:return C}h.id=`magicfeedback-${f}`,h.setAttribute("name",y),h.classList.add(m),(void 0!==A||null!==w)&&(h.value=w||A),["RADIO","MULTIPLECHOICE"].includes(v)||(h.classList.add("magicfeedback-input"),h.required=E);const I=document.createElement("label");I.setAttribute("for",`magicfeedback-${f}`),I.textContent=r(g,i),I.classList.add("magicfeedback-label");const D=document.createElement("label");if(D.textContent=r(null==k?void 0:k.subtitle,i),D.classList.add("magicfeedback-sublabel"),(null===(c=null==k?void 0:k.subtitleStyle)||void 0===c?void 0:c.includes("italic"))&&(D.style.fontStyle="italic"),(null===(u=null==k?void 0:k.subtitleStyle)||void 0===u?void 0:u.includes("bold"))&&(D.style.fontWeight="bold"),(null===(p=null==k?void 0:k.subtitleStyle)||void 0===p?void 0:p.includes("underline"))&&(D.style.textDecoration="underline"),["CONSENT"].includes(v))C.classList.add("magicfeedback-consent-container"),C.appendChild(h),C.appendChild(I),C.appendChild(D);else{if("slim"!==t&&(C.appendChild(I),C.appendChild(D),void 0!==(null==k?void 0:k.general)&&""!==(null==k?void 0:k.general))){const Pe=document.createElement("img");Pe.src=null==k?void 0:k.general,Pe.classList.add("magicfeedback-image"),Pe.style.maxWidth="auto",Pe.style.height="400px",Pe.style.margin="10px 0",C.appendChild(Pe)}if("LONGTEXT"===v&&L>0){const Se=document.createElement("div");if(Se.classList.add("magicfeedback-counter"),Se.textContent=`${h.value.length}/${L}`,Se.style.textAlign="right",Se.style.fontSize="15px",Se.style.marginTop="5px",h.addEventListener("input",(()=>{Se.textContent=`${h.value.length}/${L}`})),C.appendChild(h),C.appendChild(Se),(null==k?void 0:k.extraOption)&&(null==k?void 0:k.extraOptionText)){const Oe=document.createElement("div");Oe.classList.add("magicfeedback-skip-container"),Oe.classList.add("magicfeedback-checkbox-container"),Oe.style.display="flex",Oe.style.justifyContent="flex-start";const Ne=document.createElement("input");Ne.classList.add("magicfeedback-skip"),Ne.type="checkbox",Ne.id=`skip-${y}`,Ne.name=y,Ne.value="-",Ne.style.cursor="pointer";const Ie=document.createElement("label");Ie.htmlFor=`skip-${y}`,Ie.textContent=null==k?void 0:k.extraOptionText,Ie.style.fontSize="15px",Ie.style.cursor="pointer",Ie.style.margin="0 5px",Ne.addEventListener("click",(()=>{h.value="-",d&&d()})),Oe.appendChild(Ne),Oe.appendChild(Ie),C.appendChild(Oe)}}else C.appendChild(h)}return C}(m,i,l,`${s}${p?`/${h}`:""}`,1===t.length?c:void 0);u.push(e)}})),u},t.renderActions=function(e="",t,i="Submit",n="Back",a="Next"){const s=document.createElement("div");s.classList.add("magicfeedback-action-container");const r=document.createElement("button");r.id="magicfeedback-submit",r.type="submit",r.classList.add("magicfeedback-submit"),r.textContent="MAGICSURVEY"===e?a||"Next":i||"Submit";const o=document.createElement("button");return o.id="magicfeedback-back",o.type="button",o.classList.add("magicfeedback-back"),o.textContent=n||"Back",o.addEventListener("click",t),o.addEventListener("click",(()=>{r.removeAttribute("disabled")})),"MAGICSURVEY"===e&&s.appendChild(o),s.appendChild(r),s},t.renderError=function(e){const t=document.createElement("div");return t.classList.add("magicfeedback-error"),t.textContent=e,t},t.renderSuccess=function(e){const t=document.createElement("div");return t.classList.add("magicfeedback-success"),t.textContent=e,t},t.renderStartMessage=function(e,t=!1,i="Go!",n=()=>{}){const a=document.createElement("div");a.classList.add("magicfeedback-start-message-container");const s=document.createElement("div");if(s.classList.add("magicfeedback-start-message"),s.innerHTML=e,a.appendChild(s),t){const e=document.createElement("button");e.id="magicfeedback-start-message-button",e.classList.add("magicfeedback-start-message-button"),e.textContent=i,e.addEventListener("click",(()=>n())),a.appendChild(e)}return a}},313:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function o(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getFollowUpQuestion=t.sendFeedback=t.getQuestions=t.getSessionForm=t.getForm=t.validateEmail=void 0;const s=a(i(945)),r=a(i(330)),o=i(857),l={Accept:"application/json","Magicfeedback-Sdk-Version":r.default.version,"x-magicfeedback-parameters":window.location.search||""};t.validateEmail=function(e){return/\S+@\S+\.\S+/.test(e)},t.getForm=function(e,t,i,a){return n(this,void 0,void 0,(function*(){try{const n=yield(0,s.default)(e+o.endpoints.sdk.app_info(t,i),{method:"GET",headers:l});return yield n.json()}catch(e){a.err(e)}}))},t.getSessionForm=function(e,t,i){return n(this,void 0,void 0,(function*(){try{const i=yield(0,s.default)(e+o.endpoints.sdk.session(t),{method:"GET",headers:l});return yield i.json()}catch(e){i.err(e)}}))},t.getQuestions=function(e,t,i,a){return n(this,void 0,void 0,(function*(){try{const n=yield(0,s.default)(e+o.endpoints.sdk.app(t,i),{method:"GET",headers:l});if(n.ok){const e=yield n.json();return a.log(`Received questions for app ${t}`,e),e}throw a.err(`Failed to get questions for app ${t}:`,n.status,n.statusText),new Error("[MagicFeedback] Bad response from server")}catch(e){return a.err(e),[]}}))},t.sendFeedback=function(e,t,i){return n(this,void 0,void 0,(function*(){try{const n=yield(0,s.default)(e+o.endpoints.sdk.feedback,{method:"POST",headers:Object.assign({"Content-Type":"application/json"},l),body:JSON.stringify(t)});if(n.ok)return i.log(`Form ${t.integration} submitted successfully!`),(yield n.json()).sessionId;throw i.err(`Failed to submit form ${t.integration}:`,n.status,n.statusText),new Error(n.statusText)}catch(e){return i.err(e),""}}))},t.getFollowUpQuestion=function(e,t,i){return n(this,void 0,void 0,(function*(){try{const n=yield(0,s.default)(e+o.endpoints.sdk.followUpQuestion,{method:"POST",headers:Object.assign({"Content-Type":"application/json"},l),body:JSON.stringify(t)});if(n.ok)return i.log(`Received follow up question for form ${t.integration}`),(yield n.json())||"";throw i.err(`Failed to get follow up question for form ${t.integration}:`,n.status,n.statusText),new Error(n.statusText)}catch(e){return i.err(e),""}}))}},256:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Log=void 0,t.Log=class{constructor(e){this.config=e}log(...e){this.config.get("debug")&&console.log("[MagicFeedback]:",...e)}err(...e){console.error("[MagicFeedback]:",...e)}}},330:e=>{"use strict";e.exports=JSON.parse('{"name":"@magicfeedback/native","version":"2.1.2-beta.2","main":"./dist/magicfeedback-sdk.node.js","browser":"./dist/magicfeedback-sdk.browser.js","types":"./dist/types/src/index.d.ts","repository":{"type":"git","url":"git+ssh://git@github.com/MagicFeedback/magicfeedback-sdk.git"},"author":"farias@magicfeedback.io","license":"MIT","private":false,"scripts":{"dev":"vite","build":"webpack","build:watch":"webpack --watch --mode development","publish":"npm publish --access public","publish:beta":"npm publish --access public --tag beta","publish:alpha":"npm publish --access public --tag alpha","test":"jest","test:watch":"jest --watchAll","coverage":"vitest run --coverage"},"files":["dist"],"devDependencies":{"@babel/preset-typescript":"^7.22.5","@types/node":"^17.0.21","@types/webpack":"^5.28.0","@types/webpack-node-externals":"^2.5.3","c8":"^7.11.0","copy-webpack-plugin":"^11.0.0","jest":"^29.5.0","jest-environment-jsdom":"^29.5.0","jest-fetch-mock":"^3.0.3","nock":"^13.2.4","ts-jest":"^29.1.0","ts-loader":"^9.2.7","ts-node":"^10.7.0","typescript":"^4.6.2","vite":"^2.8.0","vite-plugin-dts":"^0.9.9","vitest":"^0.5.9","webpack":"^5.70.0","webpack-cli":"^4.9.2","webpack-node-externals":"^3.0.0"},"dependencies":{"cross-fetch":"^3.1.5","is-bundling-for-browser-or-node":"^1.1.1"},"description":"MagicFeedbackAI JavaScript Library for [MagicFeedback.io](https://magicfeedback.io/)","bugs":{"url":"https://github.com/MagicFeedback/magicfeedback-sdk/issues"},"homepage":"https://github.com/MagicFeedback/magicfeedback-sdk#readme","directories":{"example":"examples","test":"test"},"style":"./dist/styles/magicfeedback-default.css"}')}},t={},function i(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,i),s.exports}(156).default;var e,t}));